# Use a base image with Node.js and Chromium installed
FROM node:alpine

# Set the working directory inside the container
WORKDIR /app

# Install Chromium and ChromeDriver
RUN apk add --no-cache chromium chromium-chromedriver

# Copy package.json and package-lock.json from the frontend directory
COPY package.json package-lock.json ./

# Install dependencies
RUN npm install

# Copy the rest of the application files
COPY . .

# Expose port 3000 (or any other port your server is running on)
EXPOSE 3000

# Command to run the server and execute tests in the background
CMD ["sh", "-c", "chromium-browser --headless --disable-gpu --no-sandbox --remote-debugging-port=9222 & npm start & npm run test"]